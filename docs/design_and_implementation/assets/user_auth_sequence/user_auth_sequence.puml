@startuml

actor User
participant "Client App" as App
participant "Firebase Auth" as Auth
participant "Database" as DB

== Email Sign-Up ==

User -> App: Submit email & password
App -> Auth: Create user with email/password
Auth --> App: User created (unverified)
Auth --> User: Verification link
App -> DB: Create user profile

User -> Auth: Click verification link
Auth --> App: Verification successful

== Email Sign-In ==

User -> App: Sign in with email & password
App -> Auth: Authenticate credentials
Auth -> App: User Auth profile (with verification status)

alt Email NOT verified
    App --> User: Reject login (requires verification)
else Email verified
    App -> DB: Fetch user profile
    DB --> App: User profile data
    App --> User: Login successful
end

== Google Sign-In (No verification required) ==

User -> App: Tap "Sign in with Google"
App -> Auth: Google OAuth request
Auth --> App: Return Google identity (verified)

App -> DB: Check if user profile exists
alt Profile does NOT exist
    App -> DB: Create user profile (provider: Google)
end

DB --> App: User profile data
App --> User: Login successful

@enduml
